<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Budget Meals - Smart Meal Planning</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div id="app">
        <header class="header">
            <div class="container">
                <h1><i class="fas fa-utensils"></i> Family Budget Meals</h1>
                <p class="tagline">Smart meal planning within your budget</p>
            </div>
        </header>

        <main class="main">
            <div class="container">
                <!-- Setup Form -->
                <section id="setup-section" class="section">
                    <div class="card">
                        <div class="settings-header">
                            <h2><i class="fas fa-cog"></i> AI-Powered Meal Planning</h2>
                            <div class="action-buttons">
                                <button type="button" id="load-settings-btn" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-download"></i> Load Settings
                                </button>
                                <button type="button" id="save-settings-btn" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-save"></i> Save Settings
                                </button>
                                <button type="button" id="view-saved-lists-btn" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-shopping-cart"></i> Shopping Lists
                                </button>
                            </div>
                        </div>
                        
                        <form id="meal-planner-form" class="form">
                            <!-- Family & Budget Info -->
                            <div class="form-section">
                                <h3><i class="fas fa-family"></i> Family & Budget Information</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="weekly-budget">Weekly Grocery Budget ($)</label>
                                        <input type="number" id="weekly-budget" name="weeklyBudget" min="20" step="0.01" required>
                                        <small class="form-help">Total amount you want to spend this week</small>
                                    </div>
                                    <div class="form-group">
                                        <label for="zipcode">ZIP Code</label>
                                        <input type="text" id="zipcode" name="zipcode" pattern="[0-9]{5}" maxlength="5" required>
                                        <small class="form-help">For local pricing</small>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="adults">Number of Adults</label>
                                        <input type="number" id="adults" name="adults" min="1" max="10" value="2" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="kids">Number of Children</label>
                                        <input type="number" id="kids" name="kids" min="0" max="10" value="0">
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label for="allergies">Allergies & Dietary Restrictions</label>
                                    <input type="text" id="allergies" name="allergies" placeholder="e.g., nuts, dairy, gluten-free, vegetarian">
                                </div>
                            </div>
                            
                            <!-- Breakfast Planning -->
                            <div class="form-section">
                                <h3><i class="fas fa-coffee"></i> Breakfast Planning</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="breakfast-days">Breakfasts per week</label>
                                        <select id="breakfast-days" name="breakfastDays">
                                            <option value="0">Skip breakfast planning</option>
                                            <option value="5">Weekdays only (5 days)</option>
                                            <option value="7" selected>Every day (7 days)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="breakfast-people">People eating breakfast</label>
                                        <select id="breakfast-people" name="breakfastPeople">
                                            <option value="all" selected>Everyone</option>
                                            <option value="adults">Adults only</option>
                                            <option value="kids">Kids only</option>
                                            <option value="custom">Custom count</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="breakfast-custom-group" style="display: none;">
                                        <label for="breakfast-count">Number of people</label>
                                        <input type="number" id="breakfast-count" name="breakfastCount" min="1" max="20">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Lunch Planning -->
                            <div class="form-section">
                                <h3><i class="fas fa-sandwich"></i> Lunch Planning</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="lunch-days">Lunches per week</label>
                                        <select id="lunch-days" name="lunchDays">
                                            <option value="0">Skip lunch planning</option>
                                            <option value="5">Weekdays only (5 days)</option>
                                            <option value="7" selected>Every day (7 days)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="lunch-people">People eating lunch</label>
                                        <select id="lunch-people" name="lunchPeople">
                                            <option value="all" selected>Everyone</option>
                                            <option value="adults">Adults only</option>
                                            <option value="kids">Kids only</option>
                                            <option value="custom">Custom count</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="lunch-custom-group" style="display: none;">
                                        <label for="lunch-count">Number of people</label>
                                        <input type="number" id="lunch-count" name="lunchCount" min="1" max="20">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Dinner Planning -->
                            <div class="form-section">
                                <h3><i class="fas fa-drumstick-bite"></i> Dinner Planning</h3>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="dinner-days">Dinners per week</label>
                                        <select id="dinner-days" name="dinnerDays">
                                            <option value="0">Skip dinner planning</option>
                                            <option value="5">Weekdays only (5 days)</option>
                                            <option value="7" selected>Every day (7 days)</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="dinner-people">People eating dinner</label>
                                        <select id="dinner-people" name="dinnerPeople">
                                            <option value="all" selected>Everyone</option>
                                            <option value="adults">Adults only</option>
                                            <option value="kids">Kids only</option>
                                            <option value="custom">Custom count</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="dinner-custom-group" style="display: none;">
                                        <label for="dinner-count">Number of people</label>
                                        <input type="number" id="dinner-count" name="dinnerCount" min="1" max="20">
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Preferences -->
                            <div class="form-section">
                                <h3><i class="fas fa-heart"></i> Meal Preferences</h3>
                                <div class="form-group">
                                    <label>Preferred Cuisines</label>
                                    <div class="checkbox-group">
                                        <label><input type="checkbox" name="cuisines" value="american"> American</label>
                                        <label><input type="checkbox" name="cuisines" value="italian"> Italian</label>
                                        <label><input type="checkbox" name="cuisines" value="mexican"> Mexican</label>
                                        <label><input type="checkbox" name="cuisines" value="asian"> Asian</label>
                                        <label><input type="checkbox" name="cuisines" value="mediterranean"> Mediterranean</label>
                                        <label><input type="checkbox" name="cuisines" value="comfort"> Comfort Food</label>
                                    </div>
                                </div>
                                
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="cooking-skill">Cooking Skill Level</label>
                                        <select id="cooking-skill" name="cookingSkill">
                                            <option value="beginner">Beginner (30 min or less)</option>
                                            <option value="intermediate" selected>Intermediate (45 min or less)</option>
                                            <option value="advanced">Advanced (any time)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="health-focus">Health Focus</label>
                                        <select id="health-focus" name="healthFocus">
                                            <option value="balanced" selected>Balanced nutrition</option>
                                            <option value="low-carb">Low carb</option>
                                            <option value="high-protein">High protein</option>
                                            <option value="heart-healthy">Heart healthy</option>
                                            <option value="kid-friendly">Kid-friendly</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary btn-large">
                                    <i class="fas fa-magic"></i> Generate AI Meal Plan
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Loading -->
                <section id="loading-section" class="section hidden">
                    <div class="card text-center">
                        <i class="fas fa-spinner fa-spin fa-3x"></i>
                        <h3>Creating Your Budget-Friendly Meal Plan...</h3>
                        <p>Finding the best recipes and calculating costs</p>
                    </div>
                </section>

                <!-- Results -->
                <section id="results-section" class="section hidden">
                    <div class="results-header">
                        <h2><i class="fas fa-calendar-alt"></i> Your Meal Plan</h2>
                        <div class="budget-summary">
                            <div class="budget-item">
                                <span class="label">Budget:</span>
                                <span class="value" id="total-budget">$0</span>
                            </div>
                            <div class="budget-item">
                                <span class="label">Estimated Cost:</span>
                                <span class="value" id="estimated-cost">$0</span>
                            </div>
                            <div class="budget-item">
                                <span class="label">Per Meal:</span>
                                <span class="value" id="per-meal-cost">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Meal Plan Grid -->
                    <div id="meal-plan-grid" class="meal-grid">
                        <!-- Meals will be inserted here -->
                    </div>

                    <!-- Shopping List -->
                    <div class="card">
                        <div class="shopping-list-header">
                            <h3><i class="fas fa-shopping-cart"></i> Shopping List</h3>
                            <button id="save-shopping-list-btn" class="btn btn-sm btn-secondary">
                                <i class="fas fa-bookmark"></i> Save List
                            </button>
                        </div>
                        <div id="shopping-list" class="shopping-list-checklist">
                            <!-- Shopping list will be inserted here -->
                        </div>
                        <div class="shopping-total">
                            <strong>Total Cost: <span id="shopping-total">$0.00</span></strong>
                            <p class="price-source">Prices from Walmart Store #<span id="store-number">----</span></p>
                        </div>
                    </div>

                    <!-- Website Integration Notice -->
                    <div class="card" style="background: linear-gradient(135deg, #e3f2fd, #f8f9fa); border-left: 4px solid #2196f3;">
                        <h3><i class="fas fa-globe"></i> familybudgetmeals.com</h3>
                        <p><i class="fas fa-info-circle" style="color: #2196f3; margin-right: 8px;"></i>All recipes from your meal plans will be automatically added to <strong>familybudgetmeals.com</strong> to help other families find budget-friendly meal ideas!</p>
                        <p style="font-size: 0.9em; color: #666; margin-top: 10px;"><em>Coming Soon: Visit the website to browse all community recipes and meal planning tips.</em></p>
                    </div>

                    <div class="plan-actions">
                        <button id="start-over-btn" class="btn btn-primary">
                            <i class="fas fa-arrow-left"></i> Start Over
                        </button>
                        <button id="save-all-recipes-btn" class="btn btn-secondary">
                            <i class="fas fa-file-pdf"></i> Save All Recipes to PDF
                        </button>
                        <button id="save-meal-plan-btn" class="btn btn-secondary">
                            <i class="fas fa-save"></i> Save This Meal Plan
                        </button>
                        <button id="view-saved-btn" class="btn btn-secondary">
                            <i class="fas fa-folder-open"></i> View Saved Recipes
                        </button>
                        <button id="new-plan-btn" class="btn btn-outline">
                            <i class="fas fa-refresh"></i> Create New Plan
                        </button>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Secure API and Services -->
    <script src="js/services/secureAPIClient.js"></script>
    
    <!-- Data and Utilities -->
    <script src="js/data/recipes.js"></script>
    <script src="js/data/prices.js"></script>
    <script src="js/utils/pricing.js"></script>
    <script src="js/utils/walmartAPI.js"></script>
    <script src="js/utils/mealSelector.js"></script>
    <script src="js/utils/simpleShoppingList.js"></script>
    <script src="js/utils/recipeSaver.js"></script>
    <script src="js/utils/shoppingListManager.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Initialize App -->
    <script>
        // Initialize the app when all scripts are loaded
        document.addEventListener('DOMContentLoaded', function() {
            try {
                window.app = new FamilyBudgetMealsApp();
                console.log('Family Budget Meals App initialized successfully');
            } catch (error) {
                console.error('Failed to initialize app:', error);
                document.body.innerHTML += `
                    <div style="position: fixed; top: 20px; right: 20px; background: #dc3545; color: white; padding: 15px; border-radius: 5px; z-index: 9999;">
                        ⚠️ App initialization failed. Check console for details.
                    </div>
                `;
            }
        });
    </script>
</body>
</html>